
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Code for multi-row models &#8212; cutgeneratingfunctionology 1.2+git documentation</title>
    <link rel="stylesheet" href="_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Code for classical and general dual-feasible functions" href="dff.html" />
    <link rel="icon" href="_static/sageicon.png" type="image/x-icon" />
    <!-- Thebe configuration for live code cells (https://github.com/minrk/thebelab)

  If the page contains a code cell (a `pre` tag with a sage prompt), a
  dedicated Activate button is added in the top right corner.

  When pressed, the code cells are made active: the user can edit and
  run them.

  More specifically, when pressed (thebe_activate_button_function):

  - the thebelab JavaScript library is fetched from the web;

  - each code block containing a sage: prompt is made active (thebe_activate_cells)
    (editable + Run button);

  - if the page is served by a Jupyter server which has a sagemath
    kernel, a local jupyter kernel is requested(thebe_bootstrap_local);

  - otherwise a kernel is requested from mybinder (https://mybinder.org).
  !-->
<script type="text/x-thebe-config">
  thebeConfig = {
    binderOptions: {
      repo: "mkoeppe/cutgeneratingfunctionology",
    },
    stripPrompts: {
      inPrompt: 'sage: ',
      continuationPrompt: '....: ',
      selector: 'pre:contains("sage: ")',
    },
    kernelOptions: {
      name: "sagemath",
    },
    requestKernel: true
  }
</script>

<!-- Load the Thebe activation and status field library  !-->
<script src="_static/thebe_status_field.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="_static/thebe_status_field.css"/>

<!-- Test whether some code cell contains Sage code
     If yes, setup the ThebeLab activation and status field !-->
<script>
  $(function() {
      var cellSelector = "pre:contains('sage: ')";
      if ($(cellSelector).length > 0) {
         $('<div class="thebe_status_field" style="position: fixed; right:0;"></div>')
            .prependTo('div.body');
         thebe_place_activate_button();
      }
  });
</script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dff.html" title="Code for classical and general dual-feasible functions"
             accesskey="P">previous</a> |</li>
  
  <a href="http://www.sagemath.org"><img src="_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
  
        <li class="nav-item nav-item-0"><a href="index.html">cutgeneratingfunctionology 1.2+git documentation</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-cutgeneratingfunctionology.multirow">
<span id="code-for-multi-row-models"></span><h1>Code for multi-row models<a class="headerlink" href="#module-cutgeneratingfunctionology.multirow" title="Permalink to this headline">¶</a></h1>
<p>x.__init__(…) initializes x; see help(type(x)) for signature</p>
<dl class="class">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral">
<em class="property">class </em><code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">PiecewisePolynomial_polyhedral</code><span class="sig-paren">(</span><em>polyhedron_function_pairs</em>, <em>periodic_extension=False</em>, <em>is_continuous=None</em>, <em>check_consistency=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://doc.sagemath.org/html/en/reference/structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Parents and Elements v8.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.sage_object.SageObject</span></code></a></p>
<p>Define a piecewise polynomial function using pairs of (polyhedron, function).</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">cutgeneratingfunctionology.multirow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">square</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h1</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="p">([(</span><span class="n">square</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">h1</span>
<span class="go">&lt;PiecewisePolynomial_polyhedral with 1 parts, </span>
<span class="go"> domain: A 2-dimensional polyhedron in ZZ^2 defined as the convex hull of 4 vertices: (A vertex at (0, 0), A vertex at (0, 1), A vertex at (1, 0), A vertex at (1, 1))</span>
<span class="go"> function: x + y&gt;</span>
<span class="gp">sage: </span><span class="n">h1</span><span class="o">.</span><span class="n">is_continuous</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">h2</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="p">([(</span><span class="n">square</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)],</span> <span class="n">is_continuous</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h1</span> <span class="o">+</span> <span class="n">h2</span> <span class="o">==</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="p">([(</span><span class="n">square</span><span class="p">,</span> <span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">))])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">h1</span> <span class="o">*</span> <span class="n">h2</span>
<span class="go">&lt;PiecewisePolynomial_polyhedral with 1 parts, </span>
<span class="go"> domain: A 2-dimensional polyhedron in ZZ^2 defined as the convex hull of 4 vertices: (A vertex at (1, 0), A vertex at (1, 1), A vertex at (0, 1), A vertex at (0, 0))</span>
<span class="go"> function: -x^2 - 2*x*y - y^2&gt;</span>
<span class="gp">sage: </span><span class="n">hmax</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">h2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">hmax</span>
<span class="go">&lt;PiecewisePolynomial_polyhedral with 1 parts, </span>
<span class="go"> domain: A 2-dimensional polyhedron in QQ^2 defined as the convex hull of 4 vertices: (A vertex at (0, 0), A vertex at (1, 1), A vertex at (0, 1), A vertex at (1, 0))</span>
<span class="go"> function: x + y&gt;</span>
<span class="gp">sage: </span><span class="n">hmax</span><span class="o">.</span><span class="n">is_continuous</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Set check_consistency=True. Compare h to g = PiecewisePolynomial_polyhedral(pairs, check_consistency=False).plot():</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">),(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">x</span><span class="p">),(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">y</span><span class="p">),(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">y</span><span class="p">)]</span>

<span class="go">#sage: h = PiecewisePolynomial_polyhedral(pairs, check_consistency=True)</span>
<span class="go">#Traceback (most recent call last):</span>
<span class="go">#...</span>
<span class="go">#ValueError: Cannot define the PiecewisePolynomial_polyhedral due to inconsistent polyhedron function pairs</span>

<span class="gp">sage: </span><span class="n">hxp</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="p">([(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">)],</span> <span class="n">is_continuous</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">hxn</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="p">([(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">x</span><span class="p">)],</span> <span class="n">is_continuous</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">hyp</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="p">([(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">y</span><span class="p">)],</span> <span class="n">is_continuous</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">hyn</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="p">([(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">y</span><span class="p">)],</span> <span class="n">is_continuous</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">hsublin</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">hxp</span><span class="p">,</span> <span class="n">hxn</span><span class="p">,</span> <span class="n">hyp</span><span class="p">,</span> <span class="n">hyn</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">hsublin</span><span class="o">.</span><span class="n">limiting_slopes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[(0, 1), (0, -1), (1, 0), (-1, 0)]</span>
<span class="gp">sage: </span><span class="n">h_restricted</span> <span class="o">=</span> <span class="n">hsublin</span><span class="o">.</span><span class="n">restricted_to_domain</span><span class="p">(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h_restricted</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># not tested</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">h_restricted</span><span class="o">.</span><span class="n">pairs</span><span class="p">())</span>
<span class="go">6</span>

<span class="gp">sage: </span><span class="n">hsquare</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="p">(</span><span class="n">h_restricted</span><span class="o">.</span><span class="n">pairs</span><span class="p">(),</span> <span class="n">periodic_extension</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">hsquare</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># not tested</span>
<span class="gp">sage: </span><span class="n">hsquare</span><span class="o">.</span><span class="n">limiting_slopes</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">[(0, 1), (0, -1), (1, 0), (-1, 0)]</span>
<span class="gp">sage: </span><span class="n">hsquare</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">hsquare</span><span class="o">.</span><span class="n">which_function</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">),(</span><span class="mi">11</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)]))</span>
<span class="go">y - 1</span>
<span class="gp">sage: </span><span class="n">hsquare</span><span class="o">.</span><span class="n">which_function</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">9</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">9</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)]))</span>
<span class="go">-x + 5</span>
<span class="gp">sage: </span><span class="n">hsquare</span><span class="o">.</span><span class="n">which_function</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">11</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">11</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)]))</span>
<span class="go">x - 5</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">hsquare</span><span class="o">.</span><span class="n">pairs</span><span class="p">())</span>
<span class="go">8</span>

<span class="gp">sage: </span><span class="n">hsquare_res</span> <span class="o">=</span> <span class="n">hsquare</span><span class="o">.</span><span class="n">restricted_to_domain</span><span class="p">(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">hsquare_res</span> <span class="o">==</span> <span class="n">h_restricted</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__add__">
<code class="descname">__add__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__add__" title="Permalink to this definition">¶</a></dt>
<dd><p>Add self and another piecewise function.
The sum is a function defined on the intersection of the domain of self and the domain of other.</p>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>x</em>, <em>*arg</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__div__">
<code class="descname">__div__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__div__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__eq__">
<code class="descname">__eq__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__eq__" title="Permalink to this definition">¶</a></dt>
<dd><p>Assume that self and other have the same domain (=union of the polyhedra). Return True if self == other on the domain.</p>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__hash__">
<code class="descname">__hash__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__hash__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>polyhedron_function_pairs</em>, <em>periodic_extension=False</em>, <em>is_continuous=None</em>, <em>check_consistency=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__mul__">
<code class="descname">__mul__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__mul__" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply self by a scalar or another piecewise function.
The product is a function defined on the intersection of the domain of self and the domain of other.</p>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__neg__">
<code class="descname">__neg__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__neg__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__repr__">
<code class="descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__repr__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__rmul__">
<code class="descname">__rmul__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__rmul__" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply self by a scalar or another piecewise function.
The product is a function defined on the intersection of the domain of self and the domain of other.</p>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__sub__">
<code class="descname">__sub__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__sub__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__weakref__">
<code class="descname">__weakref__</code><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.affine_linear_embedding">
<code class="descname">affine_linear_embedding</code><span class="sig-paren">(</span><em>A</em>, <em>b=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.affine_linear_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Given full row rank matrix A and vector b (default b = 0). 
Return the composition PiecewisePolynomial_polyhedral function x -&gt; self(A*x+b).</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">cutgeneratingfunctionology.multirow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">logging</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fn</span> <span class="o">=</span> <span class="n">hildebrand_discont_3_slope_1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">piecewise_polynomial_polyhedral_from_fast_piecewise</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h_vert_strip</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">affine_linear_embedding</span><span class="p">(</span><span class="n">matrix</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">h_diag_strip</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">affine_linear_embedding</span><span class="p">(</span><span class="n">matrix</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">h_vert_strip</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="c1"># not tested</span>
<span class="gp">sage: </span><span class="n">h_diag_strip</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># not tested</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.dim">
<code class="descname">dim</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.dim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.from_values_on_group_triangulation">
<em class="property">classmethod </em><code class="descname">from_values_on_group_triangulation</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.from_values_on_group_triangulation" title="Permalink to this definition">¶</a></dt>
<dd><p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">cutgeneratingfunctionology.multirow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>  <span class="c1"># q=3</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="o">.</span><span class="n">from_values_on_group_triangulation</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="c1"># grid=(1/qZ)^2</span>
</pre></div>
</div>
<p>Example from Equivariant III:</p>
<blockquote>
<div>sage: M = 1/4 * matrix([[0,2,2,2,2],[2,2,2,3,1],[2,2,4,2,2],[2,2,2,1,2],[2,2,2,2,3]]).transpose()  # q=5
sage: h = PiecewisePolynomial_polyhedral.from_values_on_group_triangulation(M) # grid=(1/qZ)^2</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.functions">
<code class="descname">functions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.functions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.intersection_of_domains">
<code class="descname">intersection_of_domains</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.intersection_of_domains" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of (polyhedron, f1, f2) where polyhedorn is the intersection of two polyhedra in the domains of self and of other, and f1 and f2 are the polynomial functions of self and other on the intersection.
The polyhedral domains in self and other are ordered according to decreasing dimension.</p>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.is_constantly_equal_to">
<code class="descname">is_constantly_equal_to</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.is_constantly_equal_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if self == x everywhere.</p>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.is_continuous">
<code class="descname">is_continuous</code><span class="sig-paren">(</span><em>is_continuous=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.is_continuous" title="Permalink to this definition">¶</a></dt>
<dd><p>return if the function is continuous.</p>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.is_lower_bounded_by">
<code class="descname">is_lower_bounded_by</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.is_lower_bounded_by" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if self &gt;= x everywhere.</p>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.is_non_negative">
<code class="descname">is_non_negative</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.is_non_negative" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if self &gt;= 0 everywhere.</p>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.is_upper_bounded_by">
<code class="descname">is_upper_bounded_by</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.is_upper_bounded_by" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if self &lt;= x everywhere.</p>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.limit">
<code class="descname">limit</code><span class="sig-paren">(</span><em>x</em>, <em>polyhedron=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the limit of self at x approaching from the relative interior of polyhedron,
where the input polyhedron is contained in the domain of some piece of the function.
if polyhedron=None, then return the function value at x.</p>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.limiting_slopes">
<code class="descname">limiting_slopes</code><span class="sig-paren">(</span><em>x=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.limiting_slopes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the gradients of the affine functions on the full-dim polyhedron whose closure contains x.</p>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.max">
<code class="descname">max</code><span class="sig-paren">(</span><em>other</em>, <em>*arg</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.max" title="Permalink to this definition">¶</a></dt>
<dd><p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">cutgeneratingfunctionology.multirow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">hp</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="p">([(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">hn</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="p">([(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">pairs</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">hp</span><span class="p">,</span> <span class="n">hn</span><span class="p">)</span><span class="o">.</span><span class="n">pairs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span> <span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">vertices_list</span><span class="p">()),</span> <span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="ow">in</span> <span class="n">pairs</span> <span class="p">))</span>
<span class="go">[([[-1, -1], [-1, 1], [1, -1]], -x - y), ([[-1, 1], [1, -1], [1, 1]], x + y)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.min">
<code class="descname">min</code><span class="sig-paren">(</span><em>other</em>, <em>*arg</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.min" title="Permalink to this definition">¶</a></dt>
<dd><p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">cutgeneratingfunctionology.multirow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">hp</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="p">([(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">hn</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="p">([(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">pairs</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">hp</span><span class="p">,</span> <span class="n">hn</span><span class="p">)</span><span class="o">.</span><span class="n">pairs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span> <span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">vertices_list</span><span class="p">()),</span> <span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="ow">in</span> <span class="n">pairs</span> <span class="p">))</span>
<span class="go">[([[-1, -1], [-1, 1], [1, -1]], x + y), ([[-1, 1], [1, -1], [1, 1]], -x - y)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.pairs">
<code class="descname">pairs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.pairs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>domain=None</em>, <em>alpha=0.500000000000000</em>, <em>projection=False</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">cutgeneratingfunctionology.multirow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">logging</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fn</span> <span class="o">=</span> <span class="n">hildebrand_discont_3_slope_1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">piecewise_polynomial_polyhedral_from_fast_piecewise</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h_diag_strip</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">affine_linear_embedding</span><span class="p">(</span><span class="n">matrix</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">h_diag_strip</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">show</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="s1">&#39;threejs&#39;</span><span class="p">)</span> <span class="c1">#not tested</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">h_diag_strip</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">60</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>  <span class="c1"># q=3</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="o">.</span><span class="n">from_values_on_group_triangulation</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="c1"># grid=(1/qZ)^2</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.plot_projection">
<code class="descname">plot_projection</code><span class="sig-paren">(</span><em>domain=None</em>, <em>group_triangulation=False</em>, <em>show_values_on_vertices=False</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.plot_projection" title="Permalink to this definition">¶</a></dt>
<dd><p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">cutgeneratingfunctionology.multirow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">logging</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fn</span> <span class="o">=</span> <span class="n">hildebrand_discont_3_slope_1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">piecewise_polynomial_polyhedral_from_fast_piecewise</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h_diag_strip</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">affine_linear_embedding</span><span class="p">(</span><span class="n">matrix</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">h_diag_strip</span><span class="o">.</span><span class="n">plot_projection</span><span class="p">()</span>

<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>  <span class="c1"># q=3</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="o">.</span><span class="n">from_values_on_group_triangulation</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="c1"># grid=(1/qZ)^2</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">plot_projection</span><span class="p">(</span><span class="n">group_triangulation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">PR</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]),</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]),</span> <span class="mi">0</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">plot_projection</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">xmin</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> <span class="c1"># not tested</span>

<span class="gp">sage: </span><span class="n">PR</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="p">([(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]),</span> <span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]),</span> <span class="o">-</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]),</span> <span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]),</span> <span class="o">-</span><span class="n">y</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">plot_projection</span><span class="p">(</span><span class="n">show_values_on_vertices</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]),</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]),</span> <span class="mi">1</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">plot_projection</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.polyhedra">
<code class="descname">polyhedra</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.polyhedra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.preimage">
<code class="descname">preimage</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.preimage" title="Permalink to this definition">¶</a></dt>
<dd><p>Return closure of the preimage, as a list of polyhedra, of the given value under the map self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">cutgeneratingfunctionology.multirow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">logging</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fn</span> <span class="o">=</span> <span class="n">gmic</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">piecewise_polynomial_polyhedral_from_fast_piecewise</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">delta</span> <span class="o">=</span> <span class="n">subadditivity_slack_delta</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">preimages</span> <span class="o">=</span> <span class="n">delta</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">preimages</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">preimages</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">(A vertex at (4/5, 4/5), A vertex at (4/5, 1/5), A vertex at (1/5, 4/5))</span>
<span class="gp">sage: </span><span class="n">additive_domain</span><span class="o">=</span> <span class="n">delta</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">additive_domain</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">additive_domain</span><span class="p">)</span> <span class="c1"># not tested</span>

<span class="gp">sage: </span><span class="n">PR</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]),</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]),</span> <span class="mi">0</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[]</span>

<span class="gp">sage: </span><span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]),</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]),</span> <span class="mi">1</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.restricted_to_domain">
<code class="descname">restricted_to_domain</code><span class="sig-paren">(</span><em>domain</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.restricted_to_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a PiecewisePolynomial_polyhedral which is self restricted to domain, where domain is a given polyhedron.</p>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.sage_input">
<code class="descname">sage_input</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.sage_input" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.translation">
<code class="descname">translation</code><span class="sig-paren">(</span><em>t</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.translation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the translated PiecewisePolynomial_polyhedral function x -&gt; self(x+t).</p>
</dd></dl>

<dl class="method">
<dt id="cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.which_function">
<code class="descname">which_function</code><span class="sig-paren">(</span><em>x=None</em>, <em>polyhedron=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.PiecewisePolynomial_polyhedral.which_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the function of the (first) piece whose domain contains x, if polyhedron=None;
return the function of the (first) piece whose domain contains polyhedron, otherwise.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.affine_map_for_affine_hull">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">affine_map_for_affine_hull</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.affine_map_for_affine_hull" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the an affine map x -&gt; A*x+b that maps the affine space of p to the ambient space of p.
The affine space of p (in the ambient space) is equal to {A(x) + b for x in the projected space}.
This is adapted from sage.geometry.polyhedron.base.affine_hull. 
Note that the meanings of A, b and v0  are modified. We also handle the unbounded case.</p>
</dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.div_Zk">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">div_Zk</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.div_Zk" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.is_lattice_free_polyhedron">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">is_lattice_free_polyhedron</code><span class="sig-paren">(</span><em>B</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.is_lattice_free_polyhedron" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.is_maximal_lattice_free_polyhedron">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">is_maximal_lattice_free_polyhedron</code><span class="sig-paren">(</span><em>B</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.is_maximal_lattice_free_polyhedron" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.is_volume_affine_in_f">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">is_volume_affine_in_f</code><span class="sig-paren">(</span><em>B</em>, <em>num_tests=10</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.is_volume_affine_in_f" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.lifting_regions">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">lifting_regions</code><span class="sig-paren">(</span><em>B</em>, <em>f</em>, <em>shifted=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.lifting_regions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.lifting_regions_tile_box">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">lifting_regions_tile_box</code><span class="sig-paren">(</span><em>regions</em>, <em>box=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.lifting_regions_tile_box" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.minimality_test_multirow">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">minimality_test_multirow</code><span class="sig-paren">(</span><em>fn</em>, <em>f=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.minimality_test_multirow" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if the input PiecewisePolynomial_polyhedral function <span class="math notranslate nohighlight">\(fn\)</span> is a minimal function 
for the (multi-row) group relaxation with the given <span class="math notranslate nohighlight">\(f\)</span>.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">cutgeneratingfunctionology.multirow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">logging</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARN</span><span class="p">)</span>             <span class="c1"># Suppress output in automatic tests.</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">gmic</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fn</span> <span class="o">=</span> <span class="n">piecewise_polynomial_polyhedral_from_fast_piecewise</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">minimality_test_multirow</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">ll_strong_fractional</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fn</span> <span class="o">=</span> <span class="n">piecewise_polynomial_polyhedral_from_fast_piecewise</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">minimality_test_multirow</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">h_vert_strip</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">affine_linear_embedding</span><span class="p">(</span><span class="n">matrix</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">minimality_test_multirow</span><span class="p">(</span><span class="n">h_vert_strip</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">minimality_test_multirow</span><span class="p">(</span><span class="n">h_vert_strip</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">h_diag_strip</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">affine_linear_embedding</span><span class="p">(</span><span class="n">matrix</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">minimality_test_multirow</span><span class="p">(</span><span class="n">h_diag_strip</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">])</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">hildebrand_discont_3_slope_1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fn</span> <span class="o">=</span> <span class="n">piecewise_polynomial_polyhedral_from_fast_piecewise</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h_diag_strip</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">affine_linear_embedding</span><span class="p">(</span><span class="n">matrix</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">minimality_test_multirow</span><span class="p">(</span><span class="n">h_diag_strip</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span> <span class="c1">#long time  #takes 110 seconds</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>  <span class="c1"># q=3</span>
<span class="gp">sage: </span><span class="n">fn</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="o">.</span><span class="n">from_values_on_group_triangulation</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">minimality_test_multirow</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> <span class="c1">#long time # f = [2/3, 2/3] # takes 132 seconds</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">PR</span><span class="o">.&lt;</span><span class="n">x0</span><span class="p">,</span><span class="n">x1</span><span class="o">&gt;=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fn</span> <span class="o">=</span> <span class="n">PiecewisePolynomial_polyhedral</span><span class="p">([(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)]),</span> <span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="n">x1</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)]),</span> <span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">x0</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)]),</span> <span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">x0</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">x1</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)]),</span> <span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">x0</span> <span class="o">-</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">x1</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)],</span> <span class="n">periodic_extension</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">minimality_test_multirow</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>   <span class="c1"># same function as before, minimality test is much faster when it has less pieces.</span>
<span class="go">True</span>
</pre></div>
</div>
<p>[2012-Basu-Cornuejols-Koeppe] Unique Minimal Liftings for Simplicial Polytopes - Figure 1-b:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">slopes</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">subadd_function</span> <span class="o">=</span> <span class="n">subadditive_function_from_slopes</span><span class="p">(</span><span class="n">slopes</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">minimality_test_multirow</span><span class="p">(</span><span class="n">subadd_function</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span> 
<span class="go">True</span>
<span class="gp">sage: </span><span class="c1">#volume_of_additive_domain(subadd_function)</span>
<span class="gp">sage: </span><span class="n">additive_faces</span> <span class="o">=</span> <span class="n">subadd_function</span><span class="o">.</span><span class="n">_delta</span><span class="o">.</span><span class="n">preimage</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">additive_faces</span><span class="p">)</span>
<span class="go">69</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">volume</span><span class="p">()</span> <span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="n">additive_faces</span><span class="p">)</span>
<span class="go">731/15552</span>
</pre></div>
</div>
<p>[2012-Basu-Cornuejols-Koeppe] Unique Minimal Liftings for Simplicial Polytopes - Figure 1-a.
Unique minimal lifiting property is not satisfied. See “lifting_region.sage”,
volume_of_lifting_region(polyhedron, pt, True) returns 41/60, which is less than 1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">polyhedron</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">13</span><span class="p">,</span> <span class="mi">21</span><span class="o">/</span><span class="mi">13</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">4</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">pt</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">sublin_function</span> <span class="o">=</span> <span class="n">sublinear_function_from_polyhedron_and_point</span><span class="p">(</span><span class="n">polyhedron</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">subadd_function</span> <span class="o">=</span> <span class="n">trivial_fill_in</span><span class="p">(</span><span class="n">sublin_function</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">mod_Zk</span><span class="p">(</span><span class="o">-</span><span class="n">pt</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">minimality_test_multirow</span><span class="p">(</span><span class="n">subadd_function</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>  <span class="c1">#long time #3 mins #violate the symmetry condition.</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">delta</span> <span class="o">=</span> <span class="n">subadd_function</span><span class="o">.</span><span class="n">_delta</span> <span class="c1">#long time</span>
<span class="gp">sage: </span><span class="n">delta</span><span class="o">.</span><span class="n">is_non_negative</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>3-d example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M1</span> <span class="o">=</span><span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="p">,[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">pt</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">sublin_function</span> <span class="o">=</span> <span class="n">sublinear_function_from_polyhedron_and_point</span><span class="p">(</span><span class="n">M1</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">subadd_function</span> <span class="o">=</span> <span class="n">trivial_fill_in</span><span class="p">(</span><span class="n">sublin_function</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">mod_Zk</span><span class="p">(</span><span class="o">-</span><span class="n">pt</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">minimality_test_multirow</span><span class="p">(</span><span class="n">subadd_function</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span> <span class="c1"># not tested # never terminates, uses a lot of memory</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.mod_Zk">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">mod_Zk</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.mod_Zk" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.piecewise_polynomial_polyhedral_from_fast_piecewise">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">piecewise_polynomial_polyhedral_from_fast_piecewise</code><span class="sig-paren">(</span><em>fn</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.piecewise_polynomial_polyhedral_from_fast_piecewise" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a FastPiecewise type function fn to a PiecewisePolynomial_polyhedral type one.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">cutgeneratingfunctionology.multirow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">logging</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fn</span> <span class="o">=</span> <span class="n">gmic</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">piecewise_polynomial_polyhedral_from_fast_piecewise</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.plot_polyhedron_and_f">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">plot_polyhedron_and_f</code><span class="sig-paren">(</span><em>B</em>, <em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.plot_polyhedron_and_f" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.random_point_in_polytope">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">random_point_in_polytope</code><span class="sig-paren">(</span><em>B</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.random_point_in_polytope" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.subadditive_function_from_slopes">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">subadditive_function_from_slopes</code><span class="sig-paren">(</span><em>slopes</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.subadditive_function_from_slopes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Zk-periodic subadditive PiecewisePolynomial_polyhedral function 
whose gradients at the orgin are give by the parameter slopes.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">cutgeneratingfunctionology.multirow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">subadd_function</span> <span class="o">=</span> <span class="n">subadditive_function_from_slopes</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">subadd_function</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.subadditivity_slack_delta">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">subadditivity_slack_delta</code><span class="sig-paren">(</span><em>h</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.subadditivity_slack_delta" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the subadditivity slack function Delta: (x, y) -&gt; h(x) + h(y) - h(x+y) 
of the given PiecewisePolynomial_polyhedral function h.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">cutgeneratingfunctionology.multirow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">logging</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fn</span> <span class="o">=</span> <span class="n">gmic</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">piecewise_polynomial_polyhedral_from_fast_piecewise</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">delta</span> <span class="o">=</span> <span class="n">subadditivity_slack_delta</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">delta</span><span class="o">.</span><span class="n">plot_projection</span><span class="p">(</span><span class="n">show_values_on_vertices</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">delta</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="c1"># not tested</span>
<span class="gp">sage: </span><span class="n">delta</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3/2</span>
<span class="gp">sage: </span><span class="n">delta</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.sublinear_function_from_polyhedron_and_point">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">sublinear_function_from_polyhedron_and_point</code><span class="sig-paren">(</span><em>polyhedron</em>, <em>pt</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.sublinear_function_from_polyhedron_and_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct sublinear function phi given a full-dimensional polyhedron and an interior point f.
Notice that the vector f for the group relaxation problem equals to (- pt) mod Z.</p>
<p>EXAMPLES:
[2012-Basu-Cornuejols-Koeppe] Unique Minimal Liftings for Simplicial Polytopes - Figure 1-b:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">cutgeneratingfunctionology.multirow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">polyhedron</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">pt</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sublin_function</span> <span class="o">=</span> <span class="n">sublinear_function_from_polyhedron_and_point</span><span class="p">(</span><span class="n">polyhedron</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sublin_function</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">polyhedron</span> <span class="o">-</span> <span class="n">vector</span><span class="p">(</span><span class="n">pt</span><span class="p">))</span> <span class="c1"># not tested</span>
<span class="gp">sage: </span><span class="n">sublin_function</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">subadd_function</span> <span class="o">=</span> <span class="n">trivial_fill_in</span><span class="p">(</span><span class="n">sublin_function</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">subadd_function</span> <span class="o">==</span> <span class="n">subadditive_function_from_slopes</span><span class="p">(</span><span class="n">subadd_function</span><span class="o">.</span><span class="n">limiting_slopes</span><span class="p">())</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">subadd_function</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1">#not tested</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">subadd_function</span><span class="o">.</span><span class="n">plot_projection</span><span class="p">(</span><span class="n">show_values_on_vertices</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>[2012-Basu-Cornuejols-Koeppe] Unique Minimal Liftings for Simplicial Polytopes - Figure 1-a:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">polyhedron</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">13</span><span class="p">,</span> <span class="mi">21</span><span class="o">/</span><span class="mi">13</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">4</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">pt</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sublin_function</span> <span class="o">=</span> <span class="n">sublinear_function_from_polyhedron_and_point</span><span class="p">(</span><span class="n">polyhedron</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">subadd_function</span> <span class="o">=</span> <span class="n">trivial_fill_in</span><span class="p">(</span><span class="n">sublin_function</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.sublinear_function_from_slopes">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">sublinear_function_from_slopes</code><span class="sig-paren">(</span><em>slopes</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.sublinear_function_from_slopes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a sublinear PiecewisePolynomial_polyhedral function whose gradients at the orgin are given by the parameter slopes.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">cutgeneratingfunctionology.multirow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">sublin_function</span> <span class="o">=</span> <span class="n">sublinear_function_from_slopes</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">sublin_function</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">sublin_function</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">domain</span><span class="o">=</span><span class="n">polytopes</span><span class="o">.</span><span class="n">hypercube</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="c1"># not tested</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.trivial_fill_in">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">trivial_fill_in</code><span class="sig-paren">(</span><em>sublin_function</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.trivial_fill_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Trivial fill-in. Return a Zk-periodic PiecewisePolynomial_polyhedral function.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">cutgeneratingfunctionology.multirow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">sublin_function</span> <span class="o">=</span> <span class="n">sublinear_function_from_slopes</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">subadd_function</span> <span class="o">=</span> <span class="n">trivial_fill_in</span><span class="p">(</span><span class="n">sublin_function</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">subadd_function</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="n">subadd_function</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.volume_of_additive_domain">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">volume_of_additive_domain</code><span class="sig-paren">(</span><em>h</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.volume_of_additive_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the volume of <span class="math notranslate nohighlight">\(x * y \in [0,1]^(2d)\)</span> such that <span class="math notranslate nohighlight">\(h(x) + h(y) = h((x+y) mod Z^d)\)</span>
For d=1, the result = (merit index of h) / 2.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">cutgeneratingfunctionology.multirow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">logging</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fn</span> <span class="o">=</span> <span class="n">gmic</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">piecewise_polynomial_polyhedral_from_fast_piecewise</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">volume_of_additive_domain</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">17/50</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.volume_of_lifting_region">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">volume_of_lifting_region</code><span class="sig-paren">(</span><em>B</em>, <em>f=None</em>, <em>show_plots=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.volume_of_lifting_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">cutgeneratingfunctionology.multirow</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">M11</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">volume_of_lifting_region</span><span class="p">(</span><span class="n">M11</span><span class="p">)</span>
<span class="go">11/12</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">13</span><span class="p">,</span> <span class="mi">21</span><span class="o">/</span><span class="mi">13</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">4</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">volume_of_lifting_region</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="go">1763/2600</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="o">/</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">39</span><span class="o">/</span><span class="mi">25</span><span class="p">,</span><span class="mi">27</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">volume_of_lifting_region</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="c1"># long time # 12 s</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="cutgeneratingfunctionology.multirow.volume_of_union_of_polytopes">
<code class="descclassname">cutgeneratingfunctionology.multirow.</code><code class="descname">volume_of_union_of_polytopes</code><span class="sig-paren">(</span><em>polyhedra</em><span class="sig-paren">)</span><a class="headerlink" href="#cutgeneratingfunctionology.multirow.volume_of_union_of_polytopes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="dff.html"
                        title="previous chapter">Code for classical and general dual-feasible functions</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/multirow.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dff.html" title="Code for classical and general dual-feasible functions"
             >previous</a> |</li>
  
  <a href="http://www.sagemath.org"><img src="_static/sagelogo.png" style="vertical-align: middle" title="Sage Logo"></a>
  
        <li class="nav-item nav-item-0"><a href="index.html">cutgeneratingfunctionology 1.2+git documentation</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2013-2018, Chun Yu Hong, Matthias Koeppe, Yuan Zhou, Jiawei Wang.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
  </body>
</html>